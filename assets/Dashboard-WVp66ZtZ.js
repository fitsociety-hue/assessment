import{c as f,r as c,R as D,j as e}from"./index-C7k6ct4M.js";import{U as B,D as F}from"./dataEngine-Bh55s3Y-.js";import{A as u}from"./api-D5pp2MSO.js";import{U as R}from"./users-BU_EAkb6.js";import{F as j,C as T}from"./file-text-DLDdy8GT.js";const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],E=f("circle-alert",U);const P=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],V=f("settings",P);function M(){const[n,i]=c.useState({total:0,completed:0,progress:0}),[d,o]=c.useState(!1),[a,h]=c.useState([]),[m,b]=c.useState("employee"),[y,v]=c.useState(null);D.useEffect(()=>{(async()=>{const s=await u.fetchEmployees();if(s&&Array.isArray(s)){const l=s.length;i({total:l,completed:0,progress:0})}})()},[]);const g=async(t,s)=>{const l=t.target.files[0];if(b(s),l)try{const r=await F.parseCSV(l);h(r),o(!0),t.target.value=""}catch{alert("CSV íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},S=async()=>{if(alert("ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."),m==="employee"){const t=await u.syncEmployees(a);t.success?(i(s=>({...s,total:a.length})),o(!1),alert(`${a.length}ëª…ì˜ ì§ì› ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`)):alert("ë™ê¸°í™” ì‹¤íŒ¨: "+t.error)}else C(a),o(!1),alert("í‰ê°€ ê²°ê³¼ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")},C=t=>{const s={self:.2,peer:.2,manager:.4,sub:.2},l=t.map(r=>{const k=parseFloat(r.SelfScore)||0,I=parseFloat(r.PeerScore)||0,w=parseFloat(r.ManagerScore)||0,z=parseFloat(r.SubordinateScore)||0,A=k*s.self+I*s.peer+w*s.manager+z*s.sub;return{...r,totalScore:A.toFixed(1)}});v(l)},N=(t,s,l)=>{const r=[...a];r[t][s]=l,h(r)};return e.jsxs("div",{className:"dashboard-grid animate-fade-in",children:[e.jsxs("div",{className:"card",style:{gridColumn:"1 / -1",marginBottom:"2rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{children:"ê´€ë¦¬ìë‹˜, ì•ˆë…•í•˜ì„¸ìš”."}),e.jsxs("a",{href:"#/admin/config",className:"btn btn-outline",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem"},children:[e.jsx(V,{size:18})," ì„¤ì •"]})]}),e.jsx("p",{className:"text-sub",children:"2025ë…„ ê·¼ë¬´í‰ì • ì¢…í•© í˜„í™©ì…ë‹ˆë‹¤."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1.5rem",marginTop:"1.5rem"},children:[e.jsx(p,{icon:e.jsx(R,{className:"text-blue-500"}),label:"ì „ì²´ ëŒ€ìƒì",value:n.total,sub:"í‰ê°€ ëŒ€ìƒ"}),e.jsx(p,{icon:e.jsx(j,{className:"text-teal-500"}),label:"í‰ê°€ ì œì¶œ",value:n.completed,sub:"ì™„ë£Œ ê±´ìˆ˜"}),e.jsx(p,{icon:e.jsx(T,{className:"text-indigo-500"}),label:"ì§„í–‰ë¥ ",value:`${n.progress}%`,sub:"ì „ì²´ í‰ê· "}),e.jsxs("div",{className:"card",style:{border:"2px dashed var(--border-light)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"1rem",background:"rgba(255,255,255,0.5)"},children:[e.jsx("input",{type:"file",id:"csvInput",style:{display:"none"},onChange:t=>g(t,"employee"),accept:".csv"}),e.jsxs("label",{htmlFor:"csvInput",style:{cursor:"pointer",textAlign:"center",width:"100%"},children:[e.jsx(B,{className:"text-sub",size:32,style:{marginBottom:"0.5rem"}}),e.jsx("div",{style:{fontWeight:600},children:"ì§ì› ëª…ë‹¨ ì—…ë¡œë“œ"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-sub)"},children:"CSV í˜•ì‹ ì§€ì›"})]})]}),e.jsxs("div",{className:"card",style:{border:"2px dashed var(--primary-200)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"1rem",background:"var(--primary-50)"},children:[e.jsx("input",{type:"file",id:"resultInput",style:{display:"none"},onChange:t=>g(t,"result"),accept:".csv"}),e.jsxs("label",{htmlFor:"resultInput",style:{cursor:"pointer",textAlign:"center",width:"100%"},children:[e.jsx(j,{className:"text-primary-600",size:32,style:{marginBottom:"0.5rem"}}),e.jsx("div",{style:{fontWeight:600,color:"var(--primary-700)"},children:"í‰ê°€ ê²°ê³¼ ì—…ë¡œë“œ"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--primary-600)"},children:"ì ìˆ˜ ì·¨í•© CSV ë¶„ì„"})]})]})]}),y&&e.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"#f8fafc",borderRadius:"8px"},children:[e.jsx("h3",{children:"ğŸ“Š ë¶„ì„ ê²°ê³¼ ìš”ì•½"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"1rem",background:"white"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--primary-100)"},children:[e.jsx("th",{style:{padding:"0.5rem"},children:"ì„±ëª…"}),e.jsx("th",{style:{padding:"0.5rem"},children:"ì§ìœ„"}),e.jsx("th",{style:{padding:"0.5rem"},children:"ì´ì "}),e.jsx("th",{style:{padding:"0.5rem"},children:"ë“±ê¸‰"})]})}),e.jsx("tbody",{children:y.map((t,s)=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee",textAlign:"center"},children:[e.jsx("td",{style:{padding:"0.5rem"},children:t.Name||t.name}),e.jsx("td",{style:{padding:"0.5rem"},children:t.Role||t.role}),e.jsx("td",{style:{padding:"0.5rem",fontWeight:"bold"},children:t.totalScore}),e.jsx("td",{style:{padding:"0.5rem"},children:t.totalScore>=90?"S":t.totalScore>=80?"A":"B"})]},s))})]})]})]}),e.jsxs("div",{className:"card",style:{minHeight:"400px"},children:[e.jsx("h3",{children:"ë¶€ì„œë³„ í˜„í™©"}),e.jsx("p",{className:"text-sub",children:"ì‹¤ì‹œê°„ ì œì¶œ í˜„í™© ëª¨ë‹ˆí„°ë§"}),e.jsx("div",{style:{background:"var(--bg-input)",height:"200px",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",marginTop:"1rem"},children:"ì°¨íŠ¸ ì˜ì—­ (ë°ì´í„° ì—°ë™ ì‹œ í™œì„±í™”)"})]}),e.jsxs("div",{className:"card",style:{minHeight:"400px"},children:[e.jsx("h3",{children:"ì£¼ìš” ì•Œë¦¼"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:"column",marginTop:"1.5rem"},children:[e.jsx(x,{type:"weak",msg:"ë¯¸ì œì¶œ ì¸ì› 3ëª… (ë…ì´‰ í•„ìš”)"}),e.jsx(x,{type:"info",msg:"ìš´ì˜ì§€ì›íŒ€: í‰ê°€ ì™„ë£Œìœ¨ 90% ë‹¬ì„±"}),e.jsx(x,{type:"info",msg:"ì‚¬ì—…1íŒ€: í‰ê°€ ì™„ë£Œìœ¨ 85% ë‹¬ì„±"})]})]}),d&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"card",style:{width:"80%",maxHeight:"80%",overflow:"hidden",display:"flex",flexDirection:"column",padding:"1.5rem"},children:[e.jsxs("h3",{children:["ë°ì´í„° ê²€ì¦ ë° ìˆ˜ì • (",m==="employee"?"ì§ì›ëª…ë¶€":"í‰ê°€ê²°ê³¼",")"]}),e.jsx("p",{className:"text-sub",style:{marginBottom:"1rem"},children:"ì—…ë¡œë“œëœ ë°ì´í„°ë¥¼ ê²€í† í•˜ê³  í•„ìš”ì‹œ ì§ì ‘ ìˆ˜ì •í•˜ì„¸ìš”."}),e.jsx("div",{style:{overflow:"auto",flex:1,border:"1px solid var(--border-light)",marginBottom:"1rem"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{position:"sticky",top:0,background:"var(--bg-input)"},children:a.length>0&&Object.keys(a[0]).map(t=>e.jsx("th",{style:{padding:"0.5rem"},children:t},t))})}),e.jsx("tbody",{children:a.slice(0,100).map((t,s)=>e.jsx("tr",{style:{borderBottom:"1px solid var(--border-light)"},children:Object.keys(t).map(l=>e.jsx("td",{style:{padding:"0.3rem"},children:e.jsx("input",{className:"input-field",value:t[l]||"",onChange:r=>N(s,l,r.target.value)})},l))},s))})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>o(!1),children:"ì·¨ì†Œ"}),e.jsx("button",{className:"btn btn-primary",onClick:S,children:m==="employee"?"DB ë™ê¸°í™”":"ë¶„ì„ ì‹¤í–‰"})]})]})})]})}function p({icon:n,label:i,value:d,sub:o}){return e.jsxs("div",{style:{padding:"1.5rem",background:"var(--bg-input)",borderRadius:"var(--radius-md)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[i,n]}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:700},children:d}),e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-sub)"},children:o})]})}function x({type:n,msg:i}){const d=n==="weak"?"#ef4444":"#3b82f6";return e.jsxs("div",{style:{padding:"1rem",borderLeft:`4px solid ${d}`,background:"var(--bg-input)",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(E,{size:20,color:d}),e.jsx("span",{children:i})]})}export{M as default};
