import{c as N,r,R as U,a as _,j as e}from"./index-GragHkfS.js";import{A as H}from"./api-DZ1q1-OU.js";import{E as I}from"./employees-Cx3CSt_v.js";import{U as W}from"./users-BupC3ki4.js";const Y=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],F=N("lock",Y);const G=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],O=N("user",G);function Z({onLogin:l}){const[n,b]=r.useState("staff"),[u,p]=r.useState([]),[V,v]=r.useState(!1);U.useEffect(()=>{(async()=>{v(!0);try{const s=await H.fetchEmployees();s&&Array.isArray(s)&&s.length>0?p(s):(console.log("Using local employee data"),p(I))}catch(s){console.error("API Error, using fallback",s),p(I)}v(!1)})()},[]);const[a,j]=r.useState({name:"",team:"",position:"Team Member",jobGroup:""}),[o,w]=r.useState("admin"),[h,E]=r.useState(""),[P,d]=r.useState(""),c=_(),[S,A]=r.useState(()=>localStorage.getItem("adminPassword")||"0000"),[C,B]=r.useState(()=>localStorage.getItem("hrPassword")||"0741"),[q,R]=r.useState(!1),[z,g]=r.useState(!1),[k,y]=r.useState(""),[i,x]=r.useState(""),T=async t=>{if(t.preventDefault(),d(""),n==="staff"){if(!a.name||!a.team){d("이름과 부서를 입력해주세요.");return}if(a.name==="윤제원"&&a.team==="관장"){const f=u.find(M=>M.role==="director")||{id:0,name:"윤제원",team:"관장실",position:"관장",role:"director"};l({...f,role:"director"}),c("/eval/dashboard");return}let s=!1,m=null;if(u.length>0&&(m=u.find(f=>f.name===a.name&&f.team===a.team),m&&(s=!0)),!s){alert(`'${a.name}'님은 '${a.team}' 소속으로 등록되어 있지 않습니다.
정보를 다시 확인해주세요.
(입력하신 정보가 정확한지 확인바랍니다)`);return}const $=D(m.position);l({...m,role:$}),c("/eval/dashboard")}else o==="admin"?h===S?(l({role:"admin",name:"관리자"}),c("/admin")):d("비밀번호가 올바르지 않습니다."):o==="hr"&&(h===C?(l({role:"hr",name:"인사담당자"}),c("/hr")):d("비밀번호가 올바르지 않습니다."))},D=t=>t==="관장"?"director":t==="사무국장"?"secgen":t==="팀장"?"leader":"member",L=()=>{if(k!==(o==="admin"?S:C)){alert("현재 비밀번호가 일치하지 않습니다.");return}if(i.length<4){alert("비밀번호는 4자리 이상이어야 합니다.");return}o==="admin"?(A(i),localStorage.setItem("adminPassword",i)):(B(i),localStorage.setItem("hrPassword",i)),R(!0),g(!1),x(""),y(""),alert("비밀번호가 변경되었습니다.")};return e.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:e.jsxs("div",{className:"card animate-fade-in",style:{width:"450px",padding:"2.5rem"},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary-700)"},children:"HR Insight Pro"}),e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border-light)",marginBottom:"2rem"},children:[e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:n==="staff"?"2px solid var(--primary-600)":"none",fontWeight:n==="staff"?700:400,color:n==="staff"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>b("staff"),children:"직원 접속"}),e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:n==="admin"?"2px solid var(--primary-600)":"none",fontWeight:n==="admin"?700:400,color:n==="admin"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>b("admin"),children:"관리자 접속"})]}),e.jsxs("form",{onSubmit:T,children:[n==="staff"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{className:"input-field",placeholder:"이름 (예: 홍길동)",value:a.name,onChange:t=>j({...a,name:t.target.value})}),e.jsx("input",{className:"input-field",placeholder:"부서 (예: 전략기획팀)",value:a.team,onChange:t=>j({...a,team:t.target.value})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-sub)",marginTop:"0.5rem"},children:"* 이름과 부서를 정확히 입력해주세요. (등록된 정보와 일치해야 합니다)"})]}),n==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",justifyContent:"center"},children:[e.jsxs("button",{type:"button",className:`btn ${o==="admin"?"btn-primary":"btn-outline"} `,onClick:()=>w("admin"),style:{flex:1},children:[e.jsx(O,{size:18,style:{marginRight:"0.5rem"}})," 관리자"]}),e.jsxs("button",{type:"button",className:`btn ${o==="hr"?"btn-primary":"btn-outline"} `,onClick:()=>w("hr"),style:{flex:1},children:[e.jsx(W,{size:18,style:{marginRight:"0.5rem"}})," 인사팀"]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",position:"relative"},children:[e.jsx(F,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-sub)"}}),e.jsx("input",{type:"password",className:"input-field",placeholder:"비밀번호 입력",style:{paddingLeft:"2.8rem"},value:h,onChange:t=>E(t.target.value)})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"0.5rem",marginBottom:"1rem"},children:e.jsx("button",{type:"button",style:{background:"none",border:"none",color:"var(--text-sub)",fontSize:"0.85rem",cursor:"pointer",textDecoration:"underline"},onClick:()=>g(!0),children:o==="hr"?"인사팀 비밀번호 변경":"관리자 비밀번호 변경"})})]}),P&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.9rem",margin:"1rem 0",textAlign:"center"},children:P}),e.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%",padding:"0.8rem",marginTop:"1.5rem"},children:n==="staff"?"평가 시작하기":"로그인"})]}),z&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"card",style:{width:"350px",background:"white"},children:[e.jsx("h3",{style:{marginBottom:"1.5rem"},children:o==="hr"?"인사팀 비밀번호 변경":"관리자 비밀번호 변경"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"password",className:"input-field",placeholder:"현재 비밀번호",value:k,onChange:t=>y(t.target.value)}),e.jsx("input",{type:"password",className:"input-field",placeholder:"새 비밀번호 (4자리 이상)",value:i,onChange:t=>x(t.target.value)})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>{g(!1),y(""),x("")},children:"취소"}),e.jsx("button",{className:"btn btn-primary",onClick:L,children:"변경하기"})]})]})})]})})}export{Z as default};
