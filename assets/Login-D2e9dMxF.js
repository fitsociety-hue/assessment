import{c as T,r as n,a as Z,j as e}from"./index-CgpUwMf6.js";import{A as B}from"./api-9JwOaY3o.js";import{U as F}from"./users-ygUHNPHM.js";const V=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],L=T("lock",V);const q=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],R=T("user",q);function Q({onLogin:w}){const[o,S]=n.useState("staff"),[f,x]=n.useState("login"),[g,h]=n.useState(!1),[d,r]=n.useState(""),C=Z(),[l,y]=n.useState({name:"",password:""}),[s,m]=n.useState({name:"",team:"",position:"팀원",jobGroup:"",password:""}),[a,N]=n.useState("admin"),[P,D]=n.useState(""),[k,M]=n.useState("0741"),[A,U]=n.useState("0741"),[$,b]=n.useState(!1),[I,v]=n.useState(""),[c,j]=n.useState(""),z=async t=>{const p=new TextEncoder().encode(t),i=await crypto.subtle.digest("SHA-256",p);return Array.from(new Uint8Array(i)).map(W=>W.toString(16).padStart(2,"0")).join("")},E=t=>t==="관장"?"director":t==="사무국장"?"secgen":t==="팀장"?"leader":"member",G=async t=>{if(t.preventDefault(),r(""),!l.name||!l.password){r("이름과 비밀번호를 입력해주세요.");return}h(!0);const p=await z(l.password),i=await B.loginUser({...l,password:p});if(h(!1),i.success&&i.user){const u=E(i.user.position);w({...i.user,role:u}),C("/eval/dashboard")}else r(i.message||"로그인에 실패했습니다.")},H=async t=>{if(t.preventDefault(),r(""),!s.name||!s.team||!s.password||!s.jobGroup){r("모든 항목을 입력해주세요.");return}if(!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(s.password)){r("비밀번호는 영문+숫자 숫자를 포함하여 6자 이상이어야 합니다.");return}h(!0);const i=await z(s.password),u=await B.registerUser({...s,password:i});h(!1),u.success?(alert(`회원가입이 완료되었습니다.
로그인 화면으로 이동합니다.`),x("login"),y({name:s.name,password:""})):r(u.message||"회원가입에 실패했습니다.")},_=t=>{t.preventDefault(),r(""),P===(a==="admin"?k:A)?(w({role:a,name:a==="admin"?"관리자":"인사담당자"}),C(a==="admin"?"/admin":"/hr")):r("비밀번호가 올바르지 않습니다.")},Y=()=>{if(I!==(a==="admin"?k:A)){alert("현재 비밀번호가 일치하지 않습니다.");return}if(c.length<4){alert("비밀번호는 4자리 이상이어야 합니다.");return}a==="admin"?(M(c),localStorage.setItem("adminPassword",c)):(U(c),localStorage.setItem("hrPassword",c)),b(!1),j(""),v(""),alert("비밀번호가 변경되었습니다.")};return e.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:e.jsxs("div",{className:"card animate-fade-in",style:{width:"450px",padding:"2.5rem"},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary-700)"},children:"HR Insight Pro"}),e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border-light)",marginBottom:"2rem"},children:[e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:o==="staff"?"2px solid var(--primary-600)":"none",fontWeight:o==="staff"?700:400,color:o==="staff"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>S("staff"),children:"직원 접속"}),e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:o==="admin"?"2px solid var(--primary-600)":"none",fontWeight:o==="admin"?700:400,color:o==="admin"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>S("admin"),children:"관리자 접속"})]}),o==="staff"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",justifyContent:"center"},children:[e.jsx("button",{className:`btn ${f==="login"?"btn-primary":"btn-outline"}`,onClick:()=>{x("login"),r("")},style:{flex:1},children:"로그인"}),e.jsx("button",{className:`btn ${f==="signup"?"btn-primary":"btn-outline"}`,onClick:()=>{x("signup"),r("")},style:{flex:1},children:"회원가입"})]}),f==="login"&&e.jsxs("form",{onSubmit:G,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(R,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-sub)"}}),e.jsx("input",{className:"input-field",placeholder:"이름 (예: 홍길동)",style:{paddingLeft:"2.8rem"},value:l.name,onChange:t=>y({...l,name:t.target.value})})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(L,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-sub)"}}),e.jsx("input",{type:"password",className:"input-field",placeholder:"비밀번호",style:{paddingLeft:"2.8rem"},value:l.password,onChange:t=>y({...l,password:t.target.value})})]})]}),d&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.9rem",margin:"1rem 0",textAlign:"center"},children:d}),e.jsx("button",{type:"submit",disabled:g,className:"btn btn-primary",style:{width:"100%",padding:"0.8rem",marginTop:"1.5rem"},children:g?"확인 중...":"평가 시작하기"})]}),f==="signup"&&e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{className:"input-field",placeholder:"이름 (예: 홍길동)",value:s.name,onChange:t=>m({...s,name:t.target.value})}),e.jsx("input",{className:"input-field",placeholder:"부서 (예: 전략기획팀)",value:s.team,onChange:t=>m({...s,team:t.target.value})}),e.jsxs("select",{className:"input-field",value:s.position,onChange:t=>m({...s,position:t.target.value}),children:[e.jsx("option",{value:"팀원",children:"팀원"}),e.jsx("option",{value:"팀장",children:"팀장"}),e.jsx("option",{value:"사무국장",children:"사무국장"}),e.jsx("option",{value:"관장",children:"관장"})]}),e.jsx("input",{className:"input-field",placeholder:"직종 (예: 사회복지사)",value:s.jobGroup,onChange:t=>m({...s,jobGroup:t.target.value})}),e.jsx("input",{type:"password",className:"input-field",placeholder:"비밀번호 설정 (영문+숫자 6자 이상)",value:s.password,onChange:t=>m({...s,password:t.target.value})})]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-sub)",marginTop:"0.5rem"},children:"* 기존 직원은 이름과 부서가 일치하면 자동으로 연동됩니다."}),d&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.9rem",margin:"1rem 0",textAlign:"center"},children:d}),e.jsx("button",{type:"submit",disabled:g,className:"btn btn-primary",style:{width:"100%",padding:"0.8rem",marginTop:"1.5rem"},children:g?"처리 중...":"가입하기"})]})]}),o==="admin"&&e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",justifyContent:"center"},children:[e.jsxs("button",{type:"button",className:`btn ${a==="admin"?"btn-primary":"btn-outline"} `,onClick:()=>N("admin"),style:{flex:1},children:[e.jsx(R,{size:18,style:{marginRight:"0.5rem"}})," 관리자"]}),e.jsxs("button",{type:"button",className:`btn ${a==="hr"?"btn-primary":"btn-outline"} `,onClick:()=>N("hr"),style:{flex:1},children:[e.jsx(F,{size:18,style:{marginRight:"0.5rem"}})," 인사팀"]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",position:"relative"},children:[e.jsx(L,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-sub)"}}),e.jsx("input",{type:"password",className:"input-field",placeholder:"비밀번호 입력",style:{paddingLeft:"2.8rem"},value:P,onChange:t=>D(t.target.value)})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"0.5rem",marginBottom:"1rem"},children:e.jsx("button",{type:"button",style:{background:"none",border:"none",color:"var(--text-sub)",fontSize:"0.85rem",cursor:"pointer",textDecoration:"underline"},onClick:()=>b(!0),children:a==="hr"?"인사팀 비밀번호 변경":"관리자 비밀번호 변경"})}),d&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.9rem",margin:"1rem 0",textAlign:"center"},children:d}),e.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%",padding:"0.8rem",marginTop:"1.5rem"},children:"로그인"})]}),$&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"card",style:{width:"350px",background:"white"},children:[e.jsx("h3",{style:{marginBottom:"1.5rem"},children:a==="hr"?"인사 비밀번호 변경":"관리자 비밀번호 변경"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"password",className:"input-field",placeholder:"현재 비밀번호",value:I,onChange:t=>v(t.target.value)}),e.jsx("input",{type:"password",className:"input-field",placeholder:"새 비밀번호 (4자리 이상)",value:c,onChange:t=>j(t.target.value)})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>{b(!1),v(""),j("")},children:"취소"}),e.jsx("button",{className:"btn btn-primary",onClick:Y,children:"변경하기"})]})]})})]})})}export{Q as default};
