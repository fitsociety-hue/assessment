import{c as L,r as s,R,a as A,j as e}from"./index-BqY5JvmB.js";import{A as D}from"./api-DZ1q1-OU.js";import{U as z}from"./users-B7p9De9p.js";const E=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],T=L("lock",E);function F({onLogin:c}){const[a,h]=s.useState("staff"),[g,w]=s.useState([]),[$,x]=s.useState(!1);R.useEffect(()=>{(async()=>{x(!0);const r=await D.fetchEmployees();r&&Array.isArray(r)&&(w(r),console.log("DB Loaded:",r.length,"employees")),x(!1)})()},[]);const[n,i]=s.useState({name:"",team:"",position:"Team Member",jobGroup:""}),[o,y]=s.useState("admin"),[m,C]=s.useState(""),[b,l]=s.useState(""),f=A(),[v,S]=s.useState(()=>localStorage.getItem("adminPassword")||"0741"),[G,k]=s.useState(!1),[N,u]=s.useState(!1),[d,j]=s.useState(""),P=async t=>{if(t.preventDefault(),l(""),a==="staff"){if(!n.name||!n.team){l("이름과 부서를 입력해주세요.");return}if(g.length>0&&!g.find(p=>p.name===n.name&&p.team===n.team)&&!window.confirm(`데이터베이스에서 '${n.name}'(${n.team}) 직원을 찾을 수 없습니다.

그래도 계속하시겠습니까 ? (DB 미등록 사용자로 진행)`))return;const r=I(n.position);c({...n,role:r}),f("/eval/dashboard")}else o==="admin"?m===v?(c({role:"admin",name:"관리자"}),f("/admin")):l("비밀번호가 올바르지 않습니다."):o==="hr"&&(m===v?(c({role:"hr",name:"인사담당자"}),f("/hr")):l("비밀번호가 올바르지 않습니다."))},I=t=>t==="관장"?"director":t==="사무국장"?"secgen":t==="팀장"?"leader":"member",B=()=>{if(d.length<4){alert("비밀번호는 4자리 이상이어야 합니다.");return}S(d),localStorage.setItem("adminPassword",d),k(!0),u(!1),j(""),alert("비밀번호가 변경되었습니다. 새로운 비밀번호로 로그인해주세요.")};return e.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:e.jsxs("div",{className:"card animate-fade-in",style:{width:"450px",padding:"2.5rem"},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary-700)"},children:"HR Insight Pro"}),e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border-light)",marginBottom:"2rem"},children:[e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:a==="staff"?"2px solid var(--primary-600)":"none",fontWeight:a==="staff"?700:400,color:a==="staff"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>h("staff"),children:"직원 접속"}),e.jsx("button",{style:{flex:1,padding:"1rem",borderBottom:a==="admin"?"2px solid var(--primary-600)":"none",fontWeight:a==="admin"?700:400,color:a==="admin"?"var(--primary-700)":"var(--text-sub)",background:"none",border:"none",cursor:"pointer"},onClick:()=>h("admin"),children:"관리자 접속"})]}),e.jsxs("form",{onSubmit:P,children:[a==="staff"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{className:"input-field",placeholder:"이름 (예: 홍길동)",value:n.name,onChange:t=>i({...n,name:t.target.value})}),e.jsx("input",{className:"input-field",placeholder:"부서 (예: 전략기획팀)",value:n.team,onChange:t=>i({...n,team:t.target.value})}),e.jsxs("select",{className:"input-field",value:n.position,onChange:t=>i({...n,position:t.target.value}),children:[e.jsx("option",{value:"팀원",children:"팀원 (사회복지사 등)"}),e.jsx("option",{value:"팀장",children:"팀장"}),e.jsx("option",{value:"사무국장",children:"사무국장"}),e.jsx("option",{value:"관장",children:"관장"})]}),e.jsx("input",{className:"input-field",placeholder:"직군 (예: 사회복지사)",value:n.jobGroup,onChange:t=>i({...n,jobGroup:t.target.value})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-sub)",marginTop:"0.5rem"},children:"* 본인의 인사 정보를 정확히 입력해 주세요."})]}),a==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",justifyContent:"center"},children:[e.jsxs("button",{type:"button",className:`btn ${o==="admin"?"btn-primary":"btn-outline"} `,onClick:()=>y("admin"),style:{flex:1},children:[e.jsx(User,{size:18,style:{marginRight:"0.5rem"}})," 관리자"]}),e.jsxs("button",{type:"button",className:`btn ${o==="hr"?"btn-primary":"btn-outline"} `,onClick:()=>y("hr"),style:{flex:1},children:[e.jsx(z,{size:18,style:{marginRight:"0.5rem"}})," 인사팀"]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",position:"relative"},children:[e.jsx(T,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-sub)"}}),e.jsx("input",{type:"password",className:"input-field",placeholder:"비밀번호 입력",style:{paddingLeft:"2.8rem"},value:m,onChange:t=>C(t.target.value)})]}),o==="admin"&&e.jsx("div",{style:{textAlign:"center",marginTop:"0.5rem",marginBottom:"1rem"},children:e.jsx("button",{type:"button",style:{background:"none",border:"none",color:"var(--text-sub)",fontSize:"0.85rem",cursor:"pointer",textDecoration:"underline"},onClick:()=>u(!0),children:"비밀번호 변경"})})]}),b&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.9rem",margin:"1rem 0",textAlign:"center"},children:b}),e.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%",padding:"0.8rem",marginTop:"1.5rem"},children:a==="staff"?"평가 시작하기":"로그인"})]}),N&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"card",style:{width:"300px"},children:[e.jsx("h3",{children:"비밀번호 변경"}),e.jsx("input",{type:"password",className:"input-field",placeholder:"새 비밀번호",value:d,onChange:t=>j(t.target.value),style:{margin:"1rem 0"}}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>u(!1),children:"취소"}),e.jsx("button",{className:"btn btn-primary",onClick:B,children:"변경"})]})]})})]})})}export{F as default};
